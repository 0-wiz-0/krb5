thisconfigdir=../..
myfulldir=appl/iakerb-sample
mydir=appl/iakerb-sample
BUILDTOP=$(REL)..$(S)..
DEFINES = -DUSE_AUTOCONF_H -DGSSAPI_V2
PROG_LIBPATH=-L$(TOPLIBD)
PROG_RPATH=$(KRB5_LIBDIR)

SRCS= $(srcdir)/iakerb-client.c $(srcdir)/iakerb-misc.c $(srcdir)/iakerb-server.c

OBJS= iakerb-client.o iakerb-misc.o iakerb-server.o

all-unix:: iakerb-server iakerb-client

##WIN32##VERSIONRC = $(BUILDTOP)\windows\version.rc
##WIN32##RCFLAGS=$(CPPFLAGS) -I$(SRCTOP) -D_WIN32 -DRES_ONLY

##WIN32##GSSCLIENT=$(OUTPRE)iakerb-client.exe
##WIN32##GSSSERVER=$(OUTPRE)iakerb-server.exe

##WIN32##CLIENTRES=$(GSSCLIENT:.exe=.res)
##WIN32##SERVERRES=$(GSSSERVER:.exe=.res)

##WIN32##$(CLIENTRES): $(VERSIONRC)
##WIN32##        $(RC) $(RCFLAGS) -DGSS_CLIENT_APP -fo $@ -r $**
##WIN32##$(SERVERRES): $(VERSIONRC)
##WIN32##        $(RC) $(RCFLAGS) -DGSS_SERVER_APP -fo $@ -r $**


##WIN32##all-windows:: $(OUTPRE)iakerb-server.exe $(OUTPRE)iakerb-client.exe

iakerb-server: iakerb-server.o iakerb-misc.o $(GSS_DEPLIBS) $(KRB5_BASE_DEPLIBS)
	$(CC_LINK) -o iakerb-server iakerb-server.o iakerb-misc.o $(GSS_LIBS) $(KRB5_BASE_LIBS)

iakerb-client: iakerb-client.o iakerb-misc.o $(GSS_DEPLIBS) $(KRB5_BASE_DEPLIBS)
	$(CC_LINK) -o iakerb-client iakerb-client.o iakerb-misc.o $(GSS_LIBS) $(KRB5_BASE_LIBS)

##WIN32##$(GSSSERVER): $(OUTPRE)iakerb-server.obj $(OUTPRE)iakerb-misc.obj $(GLIB) $(KLIB) $(SERVERRES)
##WIN32##	link $(EXE_LINKOPTS) -out:$@ $** ws2_32.lib $(SCLIB)
##WIN32##	$(_VC_MANIFEST_EMBED_EXE)

##WIN32##$(GSSCLIENT): $(OUTPRE)iakerb-client.obj $(OUTPRE)iakerb-misc.obj $(GLIB) $(KLIB) $(CLIENTRES)
##WIN32##	link $(EXE_LINKOPTS) -out:$@ $** ws2_32.lib $(SCLIB)
##WIN32##	$(_VC_MANIFEST_EMBED_EXE)

clean-unix::
	$(RM) iakerb-server iakerb-client

install-unix::
	$(INSTALL_PROGRAM) iakerb-client $(DESTDIR)$(CLIENT_BINDIR)/iakerb-client
	$(INSTALL_PROGRAM) iakerb-server $(DESTDIR)$(SERVER_BINDIR)/iakerb-server
